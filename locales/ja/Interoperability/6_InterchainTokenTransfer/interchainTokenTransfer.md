これまでに、あるブロックチェーンから他のブロックチェーンへ一般的なメッセージを送信する方法例を説明しました。 今回は、あるブロックチェーンから別のブロックチェーンにメッセージとトークンを送信するコントラクトの実装をします。

## 概要

このコントラクトは、ある程度理解できると思います。 前のセクションと非常に似ており、`constructor`が`Gateway`アドレスと`Gas Service`アドレスを受け取ります。

そして、このコントラクトには、送信元のチェーンで呼び出される`sendToMany`という前のセクションと同様なパラメータを取る関数があります。

1. `_destinationChain`: トランザクションが送られるチェーン
2. `_destinationAddress`: トランザクションが送られる目的のチェーンのアドレス
3. `_destinationAddress`: トークンと一緒に送信するメッセージ。 この例では、トークン送信によって受け取るアドレスのリストがメッセージです。
4. `_symbol`: 送信されるトークンアドレスのシンボル
5. `_amount`: 送信されるトークンの量

この関数内で、`require`が既に実装されており、ガスが送られることを確実にしています。

また、基本的なERC20機能を備えており、ウォレットから呼び出してスマートコントラクトにトークンを送信することができます。 このコントラクトでは、さらに`approve`関数を呼び出し、Gatewayに対して代理で送信する資金を許可することができます。

最後に、`_executeWithToken()`関数も使用できるように実装されています。

この関数は、次のパラメータを受け取ります。

1. `_payload`: 送信元チェーンから送られてきたメッセージ
2. `_tokenSymbol`: 送信元のチェーンから送られてきたトークンのシンボル
3. `_amount`: 送信元のチェーンから送られてきたトークンの量

これで、これらのパラメータを `_execute()` 関数へ渡して適切な受信者へトークンを送信できます。

## チャレンジ

`sendToMany()`関数を完成させ、Axelar GatewayとGas Serviceを使用してインターチェントランザクションをトリガーするようにチャレンジしてみてください。

最後に、このコントラクトを2つのテストネットにデプロイし、 `sendToMany()`関数をトリガーして実際のトランザクションを<a href="https://testnet.axelarscan.io" target="_blank">Axelarscan(テストネット)ブロックエクスプローラ</a>で確認してみましょう。

### テストノート

ノート1: 推奨のERC20は、aUSDC`です。これは、ラップド版のUSDCトークンで<a href= "https://docs.axelar.dev/resources/rpc/resources" target="_blank">このDiscordファーセットボット</a>から入手できます。 `sendToMany()`関数をトリガーする場合は、シンプルに `aUSDC\`シンボルを4つ目のパラメータに渡します。

ノート2: `sendToMany()`関数をトリガーする場合は、あなたの代わりに`aUSDC`トークンを使えるように、コントラクトで`approve`をすることを忘れないでください。これを忘れると49行目にある`transferFrom()`でエラーがスローされます。
