このコントラクトチュートリアルでは、ERC721(NFT)オークションの作成方法を学びます。
Learnethの「Solidity NFTコース」を終了してから、このチュートリアルを始めることをお勧めします。

次のセクションでは、コントラクトを作成し、売り手が最高入札者にNFTをオークションで落札できるようにします。 このコントラクトは、 <a href="https://solidity-by-example.org/app/english-auction/" target="_blank">Solidity by Example</a>によって作成されました。 この最初のセクションでは、インターフェース、必要な状態変数、コンストラクタを作成します。

### インターフェース

ERC721トークンのインターフェースを作成します(5行目)。このコントラクトは、ERC721トークンとやり取りを行うのが理由です。 `safeTransferFrom`メソッド(5行目)と`transferFrom`メソッド(11行目)が必要になります。

### EnglishAuction

4つのイベント`Start`、`Bid`、`Withdraw`、`End`(19-22行目)を作成し、需要なやり取りをログとして出力します。

次に、状態変数を作成し、オンチェーンのオークションで必要となる情報のすべてを保存するようにします。

オークションしたいNFT用に2つの状態変数を作成します。 変数`nft`(24行目)は、NFTコントラクトを表すものを保存しています。インターフェースであるIERC721とNFTコントラクトのアドレスを組み合わせて、それ自体がもつ関数を呼び出せるようにします。
`nftId`(25行目)では、私たちが作成するNFTコントラクト内でオークションされる特定のトークンIDを保存します。

その後には、NFTをオークションに出品している人のアドレスを変数に保存する必要があります。これが`seller`(27行目)です。
このNFTコントラクトに、オークションの終了時に、収益を売り手に送信するようにしたいと思います。そのため、`address payable`を使うようにします。

状態変数`endAt`(28行目)を作成して、オークションの終了日を保存するようにします。
また、2つのブーリアン型である`started`(29行目)と`ended`(30行目)を作成して、オークションの開始と終了を追跡できるようにします。

変数`highestBidder`(32行目)を作成して、最高入札者のアドレスを保存します。 オークションが終了したら、NFTを最高入札者に送るようにします。

最後に、符号なし整数型(uint)で`highestBid`が必要です。これは、最高入札額を格納して`bids`(34行目)をマッピングします。この`bids`は、引き出す前のアカウントが持つ入札の総額が保存されています。詳細は次のセクションで説明します。

### コンストラクタ

競売人がコントラクトをデプロイするときに、次のいくつかの引数が必要になります。オークションにかけたいNFTコントラクトのアドレス`_nft`(37行目)、オークションにかけたいNFTトークンID`_nftId`(38行目)、オークションで最初の入札をするために越える必要のある開始価格`_startingBid`(39行目)です。

デプロイされると、引数から状態変数である`nft`(41行目)、`nftId`(42行目)、`highestBid`(45行目)に値が割り当てられます。 コントラクトをデプロイした`seller`のアドレスは、自動的にmsg.senderを通して読み取られます。そして、状態変数`seller`として保存されます(44行目)。

次のセクションでは、競売人がオークションを開始し、入札者が落札できるようにします。

## ⭐️ 演習

以下のセクションでは、演習を通してRemixにあるRemix VM環境であなたのコントラクトをテストする手順を示します。

1. NFTコントラクトをデプロイします。 「3.3 ERC721 - Token Creation」で作成したNFTコントラクトを使用してみましょう。

2. EnglishAuctionコントラクトをデプロイします。 引数として、`_nft`にはNFTコントラクトのアドレス 、`_nftId`には0、`_startingBid`は1を使用します。

3. コントラクトをデプロイしたら、コントラクトの機能である`nft`、`nftId`、`started`などが期待通りに機能するかをテストしてください。